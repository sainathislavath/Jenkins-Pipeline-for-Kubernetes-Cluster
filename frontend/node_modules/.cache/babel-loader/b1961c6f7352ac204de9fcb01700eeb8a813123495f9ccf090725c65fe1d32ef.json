{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import{cartService}from'../services/api';import{useAuth}from'./AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";const CartContext=/*#__PURE__*/createContext();export const useCart=()=>{const context=useContext(CartContext);if(!context){throw new Error('useCart must be used within a CartProvider');}return context;};export const CartProvider=_ref=>{let{children}=_ref;const{user}=useAuth();const[cart,setCart]=useState(null);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);// Load cart when user changes\nuseEffect(()=>{if(user){loadCart();}else{setCart(null);}},[user]);const loadCart=async()=>{if(!user)return;try{setLoading(true);setError(null);const response=await cartService.getCart(user._id);setCart(response.data);}catch(error){console.error('Load cart error:',error);setError('Failed to load cart');}finally{setLoading(false);}};const addToCart=async function(productId){let quantity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(!user){setError('Please login to add items to cart');return{success:false,error:'Please login to add items to cart'};}try{setError(null);const response=await cartService.addToCart(user._id,{productId,quantity});setCart(response.data.cart);return{success:true};}catch(error){var _error$response,_error$response$data;const message=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Failed to add item to cart';setError(message);return{success:false,error:message};}};const updateCartItem=async(productId,quantity)=>{if(!user)return{success:false,error:'Please login'};try{setError(null);const response=await cartService.updateCartItem(user._id,productId,{quantity});setCart(response.data.cart);return{success:true};}catch(error){var _error$response2,_error$response2$data;const message=((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Failed to update cart item';setError(message);return{success:false,error:message};}};const removeFromCart=async productId=>{if(!user)return{success:false,error:'Please login'};try{setError(null);const response=await cartService.removeFromCart(user._id,productId);setCart(response.data.cart);return{success:true};}catch(error){var _error$response3,_error$response3$data;const message=((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||'Failed to remove item from cart';setError(message);return{success:false,error:message};}};const clearCart=async()=>{if(!user)return{success:false,error:'Please login'};try{setError(null);const response=await cartService.clearCart(user._id);setCart(response.data.cart);return{success:true};}catch(error){var _error$response4,_error$response4$data;const message=((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.message)||'Failed to clear cart';setError(message);return{success:false,error:message};}};const validateCart=async()=>{if(!user||!cart||cart.items.length===0){return{isValid:false,validationResults:[]};}try{setError(null);const response=await cartService.validateCart(user._id);return response.data;}catch(error){console.error('Validate cart error:',error);return{isValid:false,validationResults:[]};}};const getCartItemsCount=()=>{return(cart===null||cart===void 0?void 0:cart.totalItems)||0;};const getCartTotal=()=>{return(cart===null||cart===void 0?void 0:cart.totalPrice)||0;};const value={cart,loading,error,addToCart,updateCartItem,removeFromCart,clearCart,validateCart,loadCart,getCartItemsCount,getCartTotal,setError};return/*#__PURE__*/_jsx(CartContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","cartService","useAuth","jsx","_jsx","CartContext","useCart","context","Error","CartProvider","_ref","children","user","cart","setCart","loading","setLoading","error","setError","loadCart","response","getCart","_id","data","console","addToCart","productId","quantity","arguments","length","undefined","success","_error$response","_error$response$data","message","updateCartItem","_error$response2","_error$response2$data","removeFromCart","_error$response3","_error$response3$data","clearCart","_error$response4","_error$response4$data","validateCart","items","isValid","validationResults","getCartItemsCount","totalItems","getCartTotal","totalPrice","value","Provider"],"sources":["E:/E-CommerceStore/frontend/src/contexts/CartContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { cartService } from '../services/api';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst CartContext = createContext();\r\n\r\nexport const useCart = () => {\r\n  const context = useContext(CartContext);\r\n  if (!context) {\r\n    throw new Error('useCart must be used within a CartProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport const CartProvider = ({ children }) => {\r\n  const { user } = useAuth();\r\n  const [cart, setCart] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  // Load cart when user changes\r\n  useEffect(() => {\r\n    if (user) {\r\n      loadCart();\r\n    } else {\r\n      setCart(null);\r\n    }\r\n  }, [user]);\r\n\r\n  const loadCart = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const response = await cartService.getCart(user._id);\r\n      setCart(response.data);\r\n    } catch (error) {\r\n      console.error('Load cart error:', error);\r\n      setError('Failed to load cart');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const addToCart = async (productId, quantity = 1) => {\r\n    if (!user) {\r\n      setError('Please login to add items to cart');\r\n      return { success: false, error: 'Please login to add items to cart' };\r\n    }\r\n\r\n    try {\r\n      setError(null);\r\n      const response = await cartService.addToCart(user._id, {\r\n        productId,\r\n        quantity\r\n      });\r\n      \r\n      setCart(response.data.cart);\r\n      return { success: true };\r\n    } catch (error) {\r\n      const message = error.response?.data?.message || 'Failed to add item to cart';\r\n      setError(message);\r\n      return { success: false, error: message };\r\n    }\r\n  };\r\n\r\n  const updateCartItem = async (productId, quantity) => {\r\n    if (!user) return { success: false, error: 'Please login' };\r\n\r\n    try {\r\n      setError(null);\r\n      const response = await cartService.updateCartItem(user._id, productId, {\r\n        quantity\r\n      });\r\n      \r\n      setCart(response.data.cart);\r\n      return { success: true };\r\n    } catch (error) {\r\n      const message = error.response?.data?.message || 'Failed to update cart item';\r\n      setError(message);\r\n      return { success: false, error: message };\r\n    }\r\n  };\r\n\r\n  const removeFromCart = async (productId) => {\r\n    if (!user) return { success: false, error: 'Please login' };\r\n\r\n    try {\r\n      setError(null);\r\n      const response = await cartService.removeFromCart(user._id, productId);\r\n      \r\n      setCart(response.data.cart);\r\n      return { success: true };\r\n    } catch (error) {\r\n      const message = error.response?.data?.message || 'Failed to remove item from cart';\r\n      setError(message);\r\n      return { success: false, error: message };\r\n    }\r\n  };\r\n\r\n  const clearCart = async () => {\r\n    if (!user) return { success: false, error: 'Please login' };\r\n\r\n    try {\r\n      setError(null);\r\n      const response = await cartService.clearCart(user._id);\r\n      \r\n      setCart(response.data.cart);\r\n      return { success: true };\r\n    } catch (error) {\r\n      const message = error.response?.data?.message || 'Failed to clear cart';\r\n      setError(message);\r\n      return { success: false, error: message };\r\n    }\r\n  };\r\n\r\n  const validateCart = async () => {\r\n    if (!user || !cart || cart.items.length === 0) {\r\n      return { isValid: false, validationResults: [] };\r\n    }\r\n\r\n    try {\r\n      setError(null);\r\n      const response = await cartService.validateCart(user._id);\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Validate cart error:', error);\r\n      return { isValid: false, validationResults: [] };\r\n    }\r\n  };\r\n\r\n  const getCartItemsCount = () => {\r\n    return cart?.totalItems || 0;\r\n  };\r\n\r\n  const getCartTotal = () => {\r\n    return cart?.totalPrice || 0;\r\n  };\r\n\r\n  const value = {\r\n    cart,\r\n    loading,\r\n    error,\r\n    addToCart,\r\n    updateCartItem,\r\n    removeFromCart,\r\n    clearCart,\r\n    validateCart,\r\n    loadCart,\r\n    getCartItemsCount,\r\n    getCartTotal,\r\n    setError\r\n  };\r\n\r\n  return (\r\n    <CartContext.Provider value={value}>\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}